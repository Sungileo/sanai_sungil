gvmodel <- gvlma(model)
summary(gvmodel)
vif(model)
model_2 <- lm(mpg~wt+disp,data = mtcars)
summary(model_2)
model_2 %>% resid()
resid <- resid(model_2)
hist(resid)
qqnorm(resid)
qqline(resid)
qqnorm(resid)
qqline(resid)
plot(fitted(model_2),resid)
plot(mtcars$wt,resid)
# Chunk 1
library(tidyverse)
library(knitr)
library(plotly)
library(readxl)
library(scales)
# Chunk 2
mtcars <- mtcars
mtcars %>% head()
# Chunk 3
vehicles <- c("Four Cylinders","Six Cylinders","Eight Cylinders")
cylinders <- mtcars %>% group_by(cyl) %>% summarize(cnt = n())
veh_cyl <- tibble(vehicles, cylinders$cnt)
plot_ly(data = veh_cyl, x = vehicles, y = cylinders$cnt, type = "bar",
text = cylinders, textposition = "auto") %>%
layout(title = "Number of Vehicles in mtcars with 4, 6, and 8 Cylinders",
titlefont = list(size = 28, color = "orange", family = "Calibri"),
yaxis = list(title = "Number of Vehicles",
font = list(color = "black", family = "Arial", size = 26),
tickfont = list(color = "black", family = "Arial", size = 20)),
xaxis = list(title = "Number of Cylinders",
titlefont = list(color = "red", family = "Times New Roman", size = 22),
tickfont = list(color = "green", family = "Cambria", size = 18)))%>%
layout(margin = list(
l = 10,
r = 10,
b = 0,
t = 40))
# Chunk 4
veh <- mtcars %>%
group_by(cyl) %>%
summarize(cnt =n()) %>%
mutate(cyl = factor(cyl))
plot_ly(data = veh,x=~cyl,y=~cnt,type="bar",text = ~cyl,textposition = "auto") %>%
layout(title = "Numberof Vehicles per cylinders",
titlefont = list(size=28, color="orange", family= "Calibri"))
# Chunk 5
library(nycflights13)
dep.delay.by.day <- flights %>%
group_by(day) %>%
summarise (mean_dep_delay=mean(dep_delay,na.rm=T))
plot_ly( data = dep.delay.by.day,
x = ~day,
y =~mean_dep_delay) %>%
add_trace(type = "scatter" ,mode = "lines+markers")
# Chunk 6
library(gapminder)
df <- gapminder
# No animation
fig <- df %>%
plot_ly(
x = ~gdpPercap,
y = ~lifeExp,
size = ~pop,
color = ~continent,
text = ~country,
hoverinfo = "text",
type = 'scatter',
mode = 'markers',
fill = ~''
) %>% layout(
xaxis = list(type = "log"))
fig
# Chunk 7
fig <- df %>%
plot_ly(
x = ~gdpPercap,
y = ~lifeExp,
size = ~pop,
color = ~continent,
frame = ~year,
text = ~country,
hoverinfo = "text",
type = 'scatter',
mode = 'markers',
fill = ~''
) %>% layout(
xaxis = list(type = "log"))
fig
# Chunk 8
p1 <- diamonds %>% ggplot(aes(x = cut, fill = clarity))+
geom_bar(position = "dodge")
ggplotly(p1)
axx <- list(
nticks = 4,
range = c(-25,75)
)
axy <- list(
nticks = 4,
range = c(-25,75)
)
axz <- list(
nticks = 4,
range = c(0,50)
)
View(axx)
x <- 70*(runif(70, 0, 1))
y <- 55*(runif(70, 0, 1))
z <- 40*(runif(70, 0, 1))
fig <- plot_ly(x = ~x, y = ~y, z = ~z, type = 'mesh3d')
fig <- fig %>% layout(scene = list(xaxis=axx,yaxis=axy,zaxis=axz))
fig
View(axx)
library(plotly)
fig <- plot_ly()
# fig <- fig %>% add_trace( ... )
# fig <- fig %>% layout( ... )
library(dash)
install.packages(c("dash","dashCoreComponents","dashHtmlComponents"))
library(dash)
library(sf)
library(tidyverse)
library(rgdal)
library(sp)
data_sp <- readOGR("C:/trainsets_2/LSMD_ADM_SECT_UMD_충남/LSMD_ADM_SECT_UMD_44.shp",encoding = "euc-kr")
data_sf = st_as_sf(data_sp)
data_sf %>% head()
data_sf %>% ggplot(aes(fill = COL_ADM_SE))+
geom_sf()+
theme_minimal()+
labs(title = "충청남도")
cheonan <- data_sf %>% filter(COL_ADM_SE=="44130")
cheonan_seobuk <- cheonan %>%
filter(substr(EMD_CD,1,5)=="44133")
cheonan_dongnam <- cheonan %>%
filter(substr(EMD_CD,1,5)=="44131")
saveRDS(cheonan, file = "cheonan_geo.rds")
cheonan <- readRDS("C:/cheonan_geo.rds")
cheonan
View(cheonan)
cheonan %>% plot
cheonan %>% plot()[1]
library(sf)
plot_ly(cheonan)
fig_2 <- plot_ly(cheonan)
fig_2
library(sf)
library(tidyverse)
library(rgdal)
data_sp <- readOGR("C:/trainsets_2/LSMD_ADM_SECT_UMD_충남/LSMD_ADM_SECT_UMD_44.shp",encoding = "euc-kr")
data_sf = st_as_sf(data_sp)
data_sf %>% head()
data_sf %>% ggplot(aes(fill = COL_ADM_SE))+
geom_sf()+
theme_minimal()+
labs(title = "충청남도")
cheonan <- data_sf %>% filter(COL_ADM_SE=="44130")
cheonan_seobuk <- cheonan %>%
filter(substr(EMD_CD,1,5)=="44133")
cheonan_dongnam <- cheonan %>%
filter(substr(EMD_CD,1,5)=="44131")
cheonan %>% ggplot(aes(fill=substr(EMD_CD,1,5)))+
geom_sf()+
theme_minimal()+
labs(title = "천안시 (구별)")+
scale_fill_discrete(name = "구",
labels = c("동남구","서북구"))
cheonan_seobuk %>% ggplot(aes(fill=EMD_NM))+
geom_sf()+
geom_sf_text(mapping = aes(label = EMD_NM))+
labs(title = "천안시 서북구 (읍면동)")+
theme_minimal()+
scale_fill_discrete(name = "읍면동")
cheonan_dongnam %>% ggplot(aes(fill=EMD_NM))+
geom_sf()+
geom_sf_text(mapping = aes(label = EMD_NM))+
labs(title = "천안시 동남구 (읍면동)")+
theme_minimal()+
scale_fill_discrete(name = "읍면동")
data <- read.csv("C:/trainsets_2/GEOCOMPS.csv")
data_sf <- data %>% st_as_sf(coords = c("Longitude","Latitude"))
st_crs(data_sf) <- 4737
st_crs(data_sf)
ggplot()+
geom_sf(data = cheonan_map,color = "black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
ggplot()+
geom_sf(data = cheonan,color = "black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn<-ggplot()+
geom_sf(data = cheonan,color = "black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
library(plotly)
gn %>% ggplotly()
gn %>% ggplotly()
library(readxl)
library(tidyverse)
library(car)
library(corrplot)
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
```{r}
data %>% head()
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
model <- lm(price_per_pyeong ~ year_built+floor+station_m+pop+dong_area+foreign_ratio+school_m + market_m,
data = data)
summary(model)
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
library(corrplot)
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
```{r}
plot(model)
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
corrplot(data_cor)
|# warning: FALSE
library(readxl)
library(tidyverse)
library(car)
library(corrplot)
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
data %>% head()
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
model <- lm(price_per_pyeong ~ year_built+floor+station_m+pop+dong_area+foreign_ratio+school_m + market_m,
data = data)
summary(model)
plot(model)
model_2 <- step(model,direction = "backward")
model_2 %>% summary
plot(model_2)
gn<-ggplot()+
geom_sf(data = cheonan,color = "black",mapping = aes(fill=EMD_NM))+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn<-ggplot()+
geom_sf(data = cheonan,color = "black",mapping = aes(fill=EMD_NM))+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
# Chunk 1
library(sf)
library(tidyverse)
library(rgdal)
library(plotly)
# Chunk 2
data_sp <- readOGR("C:/trainsets_2/LSMD_ADM_SECT_UMD_충남/LSMD_ADM_SECT_UMD_44.shp",encoding = "euc-kr")
data_sf = st_as_sf(data_sp)
data_sf %>% head()
# Chunk 3
data_sf %>% ggplot(aes(fill = COL_ADM_SE))+
geom_sf()+
theme_minimal()+
labs(title = "충청남도")
# Chunk 4
cheonan <- data_sf %>%
filter(COL_ADM_SE=="44130")
cheonan_seobuk <- cheonan %>%
filter(substr(EMD_CD,1,5)=="44133")
cheonan_dongnam <- cheonan %>%
filter(substr(EMD_CD,1,5)=="44131")
# Chunk 5
cheonan %>% ggplot(aes(fill=substr(EMD_CD,1,5)))+
geom_sf()+
theme_minimal()+
labs(title = "천안시 (구별)")+
scale_fill_discrete(name = "구",
labels = c("동남구","서북구"))
# Chunk 6
cheonan_seobuk %>% ggplot(aes(fill=EMD_NM))+
geom_sf()+
geom_sf_text(mapping = aes(label = EMD_NM))+
labs(title = "천안시 서북구 (읍면동)")+
theme_minimal()+
scale_fill_discrete(name = "읍면동")
# Chunk 7
cheonan_dongnam %>% ggplot(aes(fill=EMD_NM))+
geom_sf()+
geom_sf_text(mapping = aes(label = EMD_NM))+
labs(title = "천안시 동남구 (읍면동)")+
theme_minimal()+
scale_fill_discrete(name = "읍면동")
# Chunk 8
data <- read.csv("C:/trainsets_2/GEOCOMPS.csv")
data_sf <- data %>% st_as_sf(coords = c("Longitude","Latitude"))
st_crs(data_sf) <- 4737
st_crs(data_sf)
gn<-ggplot()+
geom_sf(data = cheonan,color = "black",mapping = aes(fill=EMD_NM))+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn
gn <- ggplot()+
geom_sf(data = cheonan,color = "black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
data <- read.csv("C:/trainsets_2/GEOCOMPS.csv")
data_sf <- data %>% st_as_sf(coords = c("Longitude","Latitude"))
st_crs(data_sf) <- 4737
st_crs(data_sf)
gn <- ggplot()+
geom_sf(data = cheonan,color = "black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn <- ggplot()+
geom_sf(data = cheonan,color = "black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn <- ggplot()+
geom_sf(data = cheonan,color = "black",fill=NA)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn <- ggplot()+
geom_sf(data = cheonan,color = "black",size = 1)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn <- ggplot()+
geom_sf(data = cheonan,fill=NA,size = 1)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn <- ggplot()+
geom_sf(data = cheonan,fill=NA,size = 3)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn
gn <- ggplot()+
geom_sf(data = cheonan,fill=NA,size = 8)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
gn <- ggplot()+
geom_sf(data = cheonan,fill=NA,size = 80)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
gn <- ggplot()+
geom_sf(data = cheonan,fill=NA,size = 0.2)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
ggplotly(gn) %>%
layout(
geo = list(
showframe = TRUE,
framecolor = 'black',
showland = TRUE,
landcolor = toRGB("gray85"),
showocean = TRUE,
oceancolor = toRGB("azure"),
showcountries = TRUE,
countrycolor = toRGB("gray70"),
showsubunits = TRUE,
subunitcolor = toRGB("gray70"),
coastlinecolor = toRGB("gray70"),
lataxis = list(range = c(36, 38)),
lonaxis = list(range = c(126, 128)),
projection = list(type = 'mercator')
),
margin = list(l = 0, r = 0, b = 0, t = 0),
line = list(width = 1) # adjust line width here
)
gn %>% ggplotly() %>% layout(geo = list(linewidth = 1))
gn %>% ggplotly() %>% layout(geo = list(linewidth = 10))
gn %>% ggplotly()
gn %>% ggplotly(linewidth = 1)
cheonan_dongnam %>% ggplot(aes(fill=EMD_NM))+
geom_sf()+
geom_sf_text(mapping = aes(label = EMD_NM))+
labs(title = "천안시 동남구 (읍면동)")+
theme_minimal()+
scale_fill_discrete(name = "읍면동") %>%
ggplotly()
chsb <- cheonan_seobuk %>% ggplot(aes(fill=EMD_NM))+
geom_sf()+
geom_sf_text(mapping = aes(label = EMD_NM))+
labs(title = "천안시 서북구 (읍면동)")+
theme_minimal()+
scale_fill_discrete(name = "읍면동")
chsb %>% ggplotly()
chdn <- cheonan_dongnam %>% ggplot(aes(fill=EMD_NM))+
geom_sf()+
geom_sf_text(mapping = aes(label = EMD_NM))+
labs(title = "천안시 동남구 (읍면동)")+
theme_minimal()+
scale_fill_discrete(name = "읍면동")
chdn %>% ggplotly()
data <- read.csv("C:/trainsets_2/GEOCOMPS.csv")
data_sf <- data %>% st_as_sf(coords = c("Longitude","Latitude"))
st_crs(data_sf) <- 4737
st_crs(data_sf)
cheonan <- cheonan %>%
filter(EMD_NM!="광덕면")
gn <- ggplot()+
geom_sf(data = cheonan,fill=NA,size = 0.2)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
install.packages("ggtext")
library(ggtext)
data <- read.csv("C:/trainsets_2/GEOCOMPS.csv")
data_sf <- data %>% st_as_sf(coords = c("Longitude","Latitude"))
st_crs(data_sf) <- 4737
st_crs(data_sf)
cheonan <- cheonan %>%
filter(EMD_NM!="광덕면")
gn <- ggplot()+
geom_sf(data = cheonan,fill = NA)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
gn
gn <- ggplot()+
geom_sf(data = cheonan,fill = NA)+
geom_sf_label(data = cheonan,aes(label=EMD_NM))+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
gn <- ggplot()+
geom_sf(data = cheonan,fill = NA)+
geom_sf_label(data = cheonan,aes(label=EMD_NM),fill= "white",color="black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn
ggplot()+
geom_sf(data = cheonan,fill = NA)+
geom_sf_label(data = cheonan,aes(label=EMD_NM),fill= "white",color="black")+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
ggplot()+
geom_sf(data = cheonan,aes(fill=EMD_NM))+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
ggplot()+
geom_sf(data = cheonan,aes(fill=EMD_NM))+
scale_fill_grey()+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
gn <- ggplot()+
geom_sf(data = cheonan,fill=NA)+
geom_sf(data = data_sf,mapping = aes(color = 건축년도))+
scale_color_gradient(low = "blue", high = "red")+
theme_minimal()
gn %>% ggplotly()
ggplotly(gn, tooltip = c("건축년도", "EMD_NM"),
hoverinfo = c("text", "text", "text"))
gn %>% ggplotly()
