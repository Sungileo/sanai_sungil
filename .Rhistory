ylab(NULL)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.8,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
arrange(month)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
arrange(month) %>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
arrange(desc(month)) %>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
mutate(month = factor(month %>% paste(),
levels = 1:12 %>% paste()))
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
mutate(month = factor(month %>% paste(),
levels = 1:12 %>% paste())) %>% View()
mutate(month = factor(month %>% paste())%>% View()
ungroup() %>%
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
mutate(month = factor(month %>% paste()))%>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B") %>% gsub("월","",month)) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B") %>% gsub("월","")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month)) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month)) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month)) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% arrange(month)%>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.numeric()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% arrange(month)%>% View()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.numeric()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% arrange(month)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
ggplot(data_2022_2,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온",
limits = c(-20,35))+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
ylab(NULL)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
scale_x_date(
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
ylab(NULL)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
scale_x_continuous( breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
ylab(NULL)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
scale_x_continuous( breaks = break_date_22) +
ylab(NULL)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
mean_temps <- temps_long %>%
group_by(month,location) %>%
summarize(mean = mean(temperature)) %>%
ungroup() %>%
mutate(month = factor(month %>% paste(),
levels = 1:12 %>% paste()))
ggplot(mean_temps,aes(x = month, y = location, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.98,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.Date()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% arrange(month)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.character()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% arrange(month)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.character()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>% arrange(month) %>% View()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.numeric()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
arrange(month) %>% mutate(month = month %>% as.character()) %>%
ungroup()  %>% View()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.numeric()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
arrange(month) %>% mutate(month = month %>% as.character()) %>%
ungroup()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month),
month = month %>% as.numeric()) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
arrange(month) %>% mutate(month = month %>% as.character()) %>%
ungroup()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month)) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B"),
month = gsub("월","",month)) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%  Vies()
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup() %>%  View()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
d <- data_2022_2 %>%
mutate(month = 일시 %>% format("%B")) %>%
group_by(month,지점명) %>%
summarize(mean = mean(평균기온..C.)) %>%
ungroup()
ggplot(d,aes(x = month, y = 지점명, fill = mean))+
geom_tile(width = .95,height = 0.95)+
scale_fill_viridis_c(option = "B",begin = 0.15, end = 0.99,
name = "temperature")+
coord_fixed(expand = FALSE)+
ylab(NULL)
ggplot(temps_long, aes(x=date,y=temperature,color=location))+
geom_line(linewidth = 1.1)+
scale_x_date(name = "month",
breaks = break_date,
labels = date_lab)+
scale_y_continuous(name = "temperature",
limits = c(0,105))+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
ggplot(data_2022_2,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온",
limits = c(-20,35))+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
library(colorspace)
RColorBrewer::display.brewer.all()
US_census <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/drive-download-20230405T011215Z-001/US_census.csv")
US_census <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/drive-download-20230405T011215Z-001/US_census.csv")
US_regions <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/drive-download-20230405T011215Z-001/US_regions.csv")
popgrowth_df <- US_census %>% left_join(US_regions) %>%
group_by(region,division,state) %>%
summarize(pop2000 = sum(pop2000, na.rm = TRUE),
pop2010 = sum(pop2010, na.rm = TRUE),
popgrowth = (pop2010-pop2000)/pop2000,
area = sum(area)) %>%
arrange(popgrowth) %>%
ungroup() %>%
mutate(state = factor(state,levels = state),
region = factor(region, levels = c("West","South","Midwest","Northwest")))
popgrowth_df %>% head()
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442")
state_colors <- region_colors[as.numeric(popgrowth_df$region)]
state_colors_dark = colorspace::darken(state_colors,0.4)
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
US_census %>% head()
US_regions %>% head()
US_census %>% head()
popgrowth_df <- US_census %>% left_join(US_regions) %>%
group_by(region,division,state) %>%
summarize(pop2000 = sum(pop2000, na.rm = TRUE),
pop2010 = sum(pop2010, na.rm = TRUE),
popgrowth = (pop2010-pop2000)/pop2000,
area = sum(area)) %>%
arrange(popgrowth) %>%
ungroup() %>%
mutate(state = factor(state,levels = state),
region = factor(region, levels = c("West","South","Midwest","Northwest")))
popgrowth_df %>% head()
popgrowth_df <- US_census %>% left_join(US_regions) %>%
group_by(region,division,state) %>%
summarize(pop2000 = sum(pop2000, na.rm = TRUE),
pop2010 = sum(pop2010, na.rm = TRUE),
popgrowth = (pop2010-pop2000)/pop2000,
area = sum(area)) %>%
arrange(popgrowth) %>%
ungroup() %>%
mutate(state = factor(state,levels = state),
region = factor(region, levels = c("West","South","Midwest","Northwest")))
popgrowth_df %>% head()
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442")
state_colors <- region_colors[as.numeric(popgrowth_df$region)]
state_colors_dark = colorspace::darken(state_colors,0.4)
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442")
state_colors <- region_colors[as.numeric(popgrowth_df$region)]
state_colors_dark = colorspace::darken(state_colors,0.4)
kor_202202 <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/202202_%EC%A3%BC%EB%AF%BC%EB%93%B1%EB%A1%9D%EC%9D%B8%EA%B5%AC%EB%B0%8F%EC%84%B8%EB%8C%80%ED%98%84%ED%99%A9.csv")
kor_202202 %>% head()
kor_202202 %>% sapply(class)
kor_202202$행정구역_코드 <- kor_202202$행정구역_코드 %>% format()
kor_202202_use <- kor_202202 %>%
filter(substr(행정구역,1,2) %in% c("서울","대전","대구","부산")) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
select(행정구역,총인구수) %>%
arrange(총인구수)
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
kor_202202_use$시도 = factor(kor_202202_use$시도,
levels = c("서울특별시","대전광역시","대구광역시","부산광역시"))
kor_202202_use %>% head()
kor_202202_use %>% summary()
state_colors <- region_colors[as.numeric(kor_202202_use$시도)]
state_colors_dark <- colorspace::darken(state_colors,0.4)
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
kor_202202_use
kor_202202_use$시도 = factor(kor_202202_use$시도,
levels = c("서울특별시","대전광역시","대구광역시","부산광역시"))
kor_202202_use
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
kor_202202_use
kor_202202_use <- kor_202202 %>%
filter(substr(행정구역,1,2) %in% c("서울","대전","대구","부산")) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
select(행정구역,총인구수) %>%
arrange(총인구수)
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
kor_202202_use
kor_202202_use$시도 = factor(kor_202202_use$시도,
levels = c("서울특별시","대전광역시","대구광역시","부산광역시"))
kor_202202_use
