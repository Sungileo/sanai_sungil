filter(substr(행정구역_코드,3,4)!="00") %>%
select(행정구역,총인구수) %>%
arrange(총인구수)
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
kor_202202_use
kor_202202_use$시도 = factor(kor_202202_use$시도,
levels = c("서울특별시","대전광역시","대구광역시","부산광역시"))
kor_202202_use
rm(list = ls())
library(ggplot2)
library(dplyr)
library(ggrepel)
library(cowplot)
US_census <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/drive-download-20230405T011215Z-001/US_census.csv")
US_regions <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/drive-download-20230405T011215Z-001/US_regions.csv")
popgrowth_df <- US_census %>% left_join(US_regions) %>%
group_by(region,division,state) %>%
summarize(pop2000 = sum(pop2000, na.rm = TRUE),
pop2010 = sum(pop2010, na.rm = TRUE),
popgrowth = (pop2010-pop2000)/pop2000,
area = sum(area)) %>%
arrange(popgrowth) %>%
ungroup() %>%
mutate(state = factor(state,levels = state),
region = factor(region, levels = c("West","South","Midwest","Northwest")))
popgrowth_df %>% head()
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442")
state_colors <- region_colors[as.numeric(popgrowth_df$region)]
state_colors_dark = colorspace::darken(state_colors,0.4)
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
popgrowth_df_2 <- popgrowth_df %>%
mutate(region_highlight = ifelse(state %in% c("Texas","Louisiana"), NA, region %>% paste()))
popgrowth_df_2 %>% head()
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()+
scale_y_continuous(name = "Population growth, 2000to 2010",
labels = scales::percent_format(scale=1),
expand = c(0,0))+
scale_fill_manual(values = region_colors,
breaks = c("West","South","Midwest",Northwest),
na.value = "#56B4E9" %>% darken(0.3))+
coord_flip()
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()+
scale_y_continuous(name = "Population growth, 2000to 2010",
labels = scales::percent_format(scale=1),
expand = c(0,0))+
scale_fill_manual(values = region_colors,
breaks = c("West","South","Midwest","Northwest"),
na.value = "#56B4E9" %>% darken(0.3))+
coord_flip()
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()+
scale_y_continuous(name = "Population growth, 2000to 2010",
labels = scales::percent_format(scale=1),
expand = c(0,0))+
scale_fill_manual(values = region_colors,
breaks = c("West","South","Midwest","Northwest"),
na.value = "#56B4E9" %>% darken(0.3))+
coord_flip()
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()+
scale_y_continuous(name = "Population growth, 2000to 2010",
labels = scales::percent_format(scale=1),
expand = c(0,0))+
scale_fill_manual(values = region_colors,
breaks = c("West","South","Midwest","Northwest"),
na.value = "#56B4E9")+
coord_flip()
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()+
scale_y_continuous(name = "Population growth, 2000to 2010",
labels = scales::percent_format(scale=1),
expand = c(0,0))+
scale_fill_manual(values = region_colors,
breaks = c("West","South","Midwest","Northwest"),
na.value = "#56B4E9")+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
axis.text.y = element_text(size=10, color = "#FFFFFFb0"
legend.position = c(.58,.68),
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442") %>%
lighten(0.4) %>% desaturate(0.8)
axis.text.y = element_text(size=10, color = "#FFFFFFb0"
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
rm(list = ls())
library(ggplot2)
library(dplyr)
library(ggrepel)
library(cowplot)
US_census <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/drive-download-20230405T011215Z-001/US_census.csv")
US_regions <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/drive-download-20230405T011215Z-001/US_regions.csv")
popgrowth_df <- US_census %>% left_join(US_regions) %>%
group_by(region,division,state) %>%
summarize(pop2000 = sum(pop2000, na.rm = TRUE),
pop2010 = sum(pop2010, na.rm = TRUE),
popgrowth = (pop2010-pop2000)/pop2000,
area = sum(area)) %>%
arrange(popgrowth) %>%
ungroup() %>%
mutate(state = factor(state,levels = state),
region = factor(region, levels = c("West","South","Midwest","Northwest")))
popgrowth_df %>% head()
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442")
state_colors <- region_colors[as.numeric(popgrowth_df$region)]
state_colors_dark = colorspace::darken(state_colors,0.4)
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442")
state_colors <- region_colors[as.numeric(popgrowth_df$region)]
state_colors_dark = colorspace::darken(state_colors,0.4)
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442") %>%
lighten(0.4) %>% desaturate(0.8)
library(colorspace)
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442") %>%
lighten(0.4) %>% desaturate(0.8)
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442") %>%
lighten(0.4) %>% desaturate(0.8)
popgrowth_df_2 <- popgrowth_df %>%
mutate(region_highlight = ifelse(state %in% c("Texas","Louisiana"), NA, region %>% paste()))
popgrowth_df_2 %>% head()
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()+
scale_y_continuous(name = "Population growth, 2000to 2010",
labels = scales::percent_format(scale=1),
expand = c(0,0))+
scale_fill_manual(values = region_colors,
breaks = c("West","South","Midwest","Northwest"),
na.value = "#56B4E9")+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df_2, aes(x = state, y= 100*popgrowth, fill = region_highlight))+
geom_col()+
scale_y_continuous(name = "Population growth, 2000to 2010",
labels = scales::percent_format(scale=1),
expand = c(0,0))+
scale_fill_manual(values = region_colors,
breaks = c("West","South","Midwest","Northwest"),
na.value = "#56B4E9")+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
region_colors <- c("#E69F00","#56B4E9","#009E73","#F0E442")
state_colors <- region_colors[as.numeric(popgrowth_df$region)]
state_colors_dark = colorspace::darken(state_colors,0.4)
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_minimal()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.58,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.7,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.99,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.5,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.7,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
legend.position = c(.7,.68)
panel.grid.major.y = element_blank(),
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.7,.68))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.7,.68),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.6,.5),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0.25,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.6,.5),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0.25,"cm"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.6,.5),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0.25,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.6,.5),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0.9,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.6,.5),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(12,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.6,.5),
legend.background = element_rect(fill="#FFFFFFb0"))
ggplot(popgrowth_df,aes(x = state, y = 100*popgrowth, fill = region))+
geom_col()+
scale_y_continuous(name = "population growth, 2000 to 2010",
labels = scales::percent_format(scale = 1),
expand = c(0,0))+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size=10,color = state_colors),
legend.position = c(.6,.5),
legend.background = element_rect(fill="#FFFFFFb0"))
kor_202202 <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/202202_%EC%A3%BC%EB%AF%BC%EB%93%B1%EB%A1%9D%EC%9D%B8%EA%B5%AC%EB%B0%8F%EC%84%B8%EB%8C%80%ED%98%84%ED%99%A9.csv")
kor_202202 %>% head()
kor_202202 %>% sapply(class)
kor_202202$행정구역_코드 <- kor_202202$행정구역_코드 %>% format()
View(kor_202202)
kor_202202_use <- kor_202202 %>%
filter(substr(행정구역,1,2) %in% c("서울","대전","대구","부산")) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
select(행정구역,총인구수) %>%
arrange(총인구수)
kor_202202_use %>% View()
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
kor_202202_use$시도 = factor(kor_202202_use$시도,
levels = c("서울특별시","대전광역시","대구광역시","부산광역시"))
kor_202202_use %>% View()
