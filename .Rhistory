coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "한숲아파트")
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "한숲아파트",label = c("a","b"))
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선")
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선",label = c("314","711"))
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선",
label = c("314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선",
label = c("314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
title("한숲아파트")+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선",
label = c("314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
labs(title = "한숲아파트")+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선",
label = c("314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
labs(tag = "한숲아파트")+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선",
label = c("314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
labs(title = "한숲아파트")+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한남대북문") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남대북문")+
scale_y_discrete(name = "노선번호",
label = c("a","b","c","d","e"))
data_3 %>%
filter(BUS_NODE_NM == "한남대북문") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남대북문")+
scale_y_discrete(name = "노선번호")+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한남대북문") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남대북문")+
scale_y_discrete(name = "노선번호",
label = c("102","605","611","706","802"))+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한남대학교" &
BUS_ROUTE_ID != 30300065) %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남대학교")+
scale_y_discrete(name = "노선번호",label = c("105","314","711"))
data_3 %>%
filter(BUS_NODE_NM == "한남대학교" &
BUS_ROUTE_ID != 30300065) %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남대학교")+
scale_y_discrete(name = "노선번호",label = c("105","314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(6:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한남로삼거리") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남로삼거리")+
scale_y_discrete(name = "노선번호",label = c(105,314,711))+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한남로삼거리") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남로삼거리")+
scale_y_discrete(name = "노선번호",label = c("105","314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3
data_3 %>% group_by(BUS_NODE_NM,HH_ID)
data_3 %>% group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT))
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT)) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt)) %>%
geom_tile()
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT)) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile()
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT)) %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile()
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT)) %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_x_continuous(name = "시간대",
breaks = c(5:22))
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
scale_y_discrete(name = "노선번호")
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
scale_y_discrete(name = "정류장")
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
scale_y_discrete(name = "정류장")
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
scale_y_discrete(name = "정류장")
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선번호",
label = c("314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
labs(title = "한숲아파트")+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
scale_y_discrete(name = "정류장")
rm(list=ls())
library(tidyverse)
daejeon_bus <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets_2/main/daejeon_bus_2.csv",sep = "|")
st_2 <- read.csv("C:/trainsets_2/station-info_4.txt",sep = "|")
st_2 <- st_2 %>% select(BUS_NODE_ID,BUS_NODE_NM)
names(st_2)[1] <- "BUS_STTN_ID"
st_3 <- daejeon_bus %>% select(HH_ID,BUS_ROUTE_ID,BUS_STTN_ID,GETON_CNT,GETOFF_CNT,TRANSF_PSNGR_CNT)
data_2 <- st_3 %>% left_join(st_2,by = "BUS_STTN_ID")
data_3 <- data_2 %>% filter(BUS_NODE_NM %in% c("한남대학교","한남로삼거리","한숲아파트","한남대북문","대전신학대학교"))
data_3 %>%
filter(BUS_NODE_NM == "한남로삼거리") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남로삼거리")+
scale_y_discrete(name = "노선번호",label = c("105","314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한남대학교" &
BUS_ROUTE_ID != 30300065) %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남대학교")+
scale_y_discrete(name = "노선번호",label = c("105","314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(6:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한남대북문") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
labs(title = "한남대북문")+
scale_y_discrete(name = "노선번호",
label = c("102","605","611","706","802"))+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
filter(BUS_NODE_NM == "한숲아파트") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>%
ggplot(aes(x=HH_ID,y=factor(BUS_ROUTE_ID),fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_y_discrete(name = "노선번호",
label = c("314","711"))+
scale_x_continuous(name = "시간대",
breaks = c(5:22))+
labs(title = "한숲아파트")+
theme(plot.margin = margin(0, 0, 0, 0))
data_3 %>%
group_by(BUS_NODE_NM,HH_ID) %>%
summarize(cnt=sum(GETON_CNT),.groups = "drop") %>%
filter(BUS_NODE_NM %in% c("한남로삼거리","한숲아파트","한남대북문")) %>%
ggplot(aes(x=HH_ID,y=BUS_NODE_NM,fill=cnt))+
geom_tile(width = .95,height = 0.95)+
coord_fixed(expand = FALSE)+
scale_fill_viridis_c(option = "B",
begin = 0.15,
end = 0.99,
name = "시간대별 승차인원 (명)",
direction = -1)+
scale_x_continuous(name = "시간대",
breaks = c(5:23))+
scale_y_discrete(name = "정류장")
View(data_3)
data_3
data_3 %>%
filter(BUS_NODE_NM == "한남대북문")
data_3 %>%
filter(BUS_NODE_NM == "한남대북문") %>% View()
data_3 %>%
filter(BUS_NODE_NM == "한남대북문") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop")
data_3 %>%
filter(BUS_NODE_NM == "한남대북문") %>%
group_by(HH_ID,BUS_ROUTE_ID) %>%
summarize(cnt = sum(GETON_CNT), .groups = "drop") %>% View()
