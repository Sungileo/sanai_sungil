mutate(행정구역_코드 = str_sub(행정구역,-11,-2)) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 %>% sapply(class)
data_202303$X2023년03월_총인구수 %>% sapply(function(x) gsub(x,",",""))
data_202303$X2023년03월_총인구수 %>% sapply(function(x) gsub(x,",","",data_202303$X2023년03월_총인구수))
data_202302$ss <- data_202303$X2023년03월_총인구수 %>% sapply(function(x) gsub(x,",","",data_202303$X2023년03월_총인구수))
View(data_202303)
data_202303$ss <- data_202303$X2023년03월_총인구수 %>% sapply(function(x) gsub(x,",","",data_202303$X2023년03월_총인구수))
View(data_202303)
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2)) %>%
filter(substr(행정구역_코드,3,4)!="00")
gsub(data_202303$X2023년03월_총인구수,",","",data_202303$X2023년03월_총인구수)
data_202303$ss <- data_202303$X2023년03월_총인구수 %>% mapply(function(x) gsub(x,",","",data_202303$X2023년03월_총인구수))
data_202303$ss <- data_202303$X2023년03월_총인구수 %>% mapply(function(x) gsub(x,",","",data_202303$X2023년03월_총인구수))
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2)) %>%
filter(substr(행정구역_코드,3,4)!="00")
data_202303
data_202303$X2023년03월_총인구수 %>% mode()
data_202303$X2023년03월_총인구수 %>% as.numeric()
data_202303$X2023년03월_총인구수 <- gsub(",","",data_202303$X2023년03월_총인구수)
data_202303
data_202303 %>% View()
data_202303$X2023년03월_총인구수 <- gsub(",","",data_202303$X2023년03월_총인구수) %>% as.numeric()
data_202303 %>% View()
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2)) %>%
filter(substr(행정구역_코드,3,4)!="00")
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),X2023년03월_총인구수 <- gsub(",","",X2023년03월_총인구수)) %>%
filter(substr(행정구역_코드,3,4)!="00")
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),X2023년03월_총인구수 <- gsub(",","",X2023년03월_총인구수)) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 %>% View()
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수)) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 %>% View()
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),
X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수) %>% as,numeric()) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),
X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수) %>% as.numeric()) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 %>% View()
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),
X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수) %>% as.numeric()) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
use_map_2 <- use_map %>% merge(data_202303,by = "행정구역_코드", all.x=T)
View(use_map_2)
use_map %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)
use_map_2 %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)
use_map_2 %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2)
)
use_map_2 %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
title("202303")
ggplot(temps_long, aes(x=date, y=temperature, color=location))+
geom_line()+
scale_x_date(name="month",
breaks = break_date,
labels = c("jan", "apr", "jul", "oct", "jan"))+
scale_y_continuous(name = "temp",
limits = c(20,105))+
theme_light()+
labs(title = "title", subtitle = "subtitle", caption = "caption", tag = "tag")
data_file <- read.csv("ncdc_normals.csv")
data_file <- read.csv("ncdc_normals.csv")
Check data information
```{r}
dim(data_file)
data_file %>% head()
data_file %>% sapply(class) # 날짜 형식 변경
dim(data_file)
Convert date format (character -\> date)
```{r}
data_file$date <- data_file$date %>% as.Date("%Y-%m-%d")
data_file$date <- data_file$date %>% as.Date("%Y-%m-%d")
data_file <- read.csv("ncdc_normals.csv")
data_file <- read.csv("ncdc_normals.csv")
data_file <- read.csv("ncdc_normals.csv")
use_map_2 %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
use_map_2 %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title="202303")
use_map_2 %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title="202303")
library(ggrepel)
rm(list = ls())
library(ggplot2)
library(dplyr)
library(ggrepel)
library(cowplot)
library(colorspace)
data_raw <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/ggplot2/mpg.csv")
data_raw %>% dim()
data_raw %>% head()
data_raw %>% summary()
data_use <- data_raw %>% select(-1)
data_use %>% head()
ggplot(data_use, aes(x=displ, y=hwy)) +
geom_point()
use_map_2 %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title="202303")
library(dplyr)
library(stringr)
library(ggplot2)
library(geojsonsf)
library(sf)
kor_sigu <- geojson_sf("https://raw.githubusercontent.com/Sungileo/trainsets/main/kor/KOR_SIGU.json")
use_map <- kor_sigu
use_map$행정구역_코드 <- paste(use_map$SIG_CD,"00000",sep = "")
data_pop <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/202303_202303_%EC%A3%BC%EB%AF%BC%EB%93%B1%EB%A1%9D%EC%9D%B8%EA%B5%AC%EB%B0%8F%EC%84%B8%EB%8C%80%ED%98%84%ED%99%A9_%EC%9B%94%EA%B0%84.csv",encoding = "utf-8")
data_pop %>% View()
data_pop %>% head()
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),
X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수) %>% as.numeric()) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303
data_202303 %>% head()
use_map <- use_map %>% merge(data_202303,by = "행정구역_코드", all.x=T)
use_map %>% ggplot(aes(fill=총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title="202303")
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title="202303")
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))
#시군구 지도 데이터, 행정구역 코드
kor_sigu <- geojson_sf("https://raw.githubusercontent.com/Sungileo/trainsets/main/kor/KOR_SIGU.json")
View(kor_sigu)
#시군구 지도 데이터, 행정구역 코드 10자리로 만들기
kor_sigu <- geojson_sf("https://raw.githubusercontent.com/Sungileo/trainsets/main/kor/KOR_SIGU.json")
use_map <- kor_sigu
use_map$행정구역_코드 <- paste(use_map$SIG_CD,"00000",sep = "")
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))
#시군구 지도 데이터, 행정구역 코드 10자리로 만들기
kor_sigu <- geojson_sf("https://raw.githubusercontent.com/Sungileo/trainsets/main/kor/KOR_SIGU.json")
use_map <- kor_sigu
use_map$행정구역_코드 <- paste(use_map$SIG_CD,"00000",sep = "")
#2023년 3월 주민등록 인구통계 데이터, 행정안전부
data_pop <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/202303_202303_%EC%A3%BC%EB%AF%BC%EB%93%B1%EB%A1%9D%EC%9D%B8%EA%B5%AC%EB%B0%8F%EC%84%B8%EB%8C%80%ED%98%84%ED%99%A9_%EC%9B%94%EA%B0%84.csv",encoding = "utf-8")
data_pop %>% head()
# 전처리, 인구수0명 출장소 제외, 행정구역 코드 10자리 추출,
# 인구수 숫자형으로 변환, 시 단위 제외, 정렬
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),
X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수) %>% as.numeric()) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 %>% head()
# 병합
use_map <- use_map %>% merge(data_202303,by = "행정구역_코드", all.x=T)
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title = "2023년 3월")
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(subtitle =  = "2023년 3월")
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(subtitle = "2023년 3월")
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title = "2023년 3월")
# 패키지
rm(list = ls())
#시군구 지도 데이터, 행정구역 코드 10자리로 만들기
kor_sigu <- geojson_sf("https://raw.githubusercontent.com/Sungileo/trainsets/main/kor/KOR_SIGU.json")
use_map <- kor_sigu
use_map$행정구역_코드 <- paste(use_map$SIG_CD,"00000",sep = "")
#2023년 3월 주민등록 인구통계 데이터, 행정안전부
data_pop <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/202303_202303_%EC%A3%BC%EB%AF%BC%EB%93%B1%EB%A1%9D%EC%9D%B8%EA%B5%AC%EB%B0%8F%EC%84%B8%EB%8C%80%ED%98%84%ED%99%A9_%EC%9B%94%EA%B0%84.csv",encoding = "utf-8")
data_pop %>% head()
# 전처리, 인구수0명 출장소 제외, 행정구역 코드 10자리 추출,
# 인구수 숫자형으로 변환, 시 단위 제외, 정렬
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),
X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수) %>% as.numeric()) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 %>% head()
# 병합
use_map <- use_map %>% merge(data_202303,by = "행정구역_코드", all.x=T)
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title = "2023년 3월")
data_file <- read.csv("ncdc_normals.csv")
data_file <- read.csv("ncdc_normals.csv")
data_file <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/ncdc_normals.csv")
dim(data_file)
data_file %>% head()
data_file %>% sapply(class) # 날짜 형식 변경
data_file$date <- data_file$date %>% as.Date("%Y-%m-%d")
data_file$station_id %>% unique() %>% length()
station_loc <- data.frame(station_id = c("USW00014819","USC00042319","USW00093107","USW00012918"),
location = c("Chicago","Death valley","San diego","Houston"))
temps_long <- data_file %>% inner_join(station_loc,by="station_id")
temps_long %>% head()
ggplot(temps_long, aes(x=date,y=temperature,color=location))+
geom_line()
date_s <- "0000-01-01" %>% as.Date("%Y-%m-%d")  #Y는 대문자
date_e <- "0001-01-01" %>% as.Date("%Y-%m-%d")
break_date <- seq.Date(date_s, date_e, by = "3 month")
ggplot(temps_long, aes(x=date, y=temperature, color=location))+
geom_line()+
scale_x_date(name="month",
breaks = break_date,
labels = c("jan", "apr", "jul", "oct", "jan"))+
theme_light()
ggplot(temps_long, aes(x=date, y=temperature, color=location))+
geom_line()+
scale_x_date(name="month",
breaks = break_date,
labels = c("jan", "apr", "jul", "oct", "jan"))+
scale_y_continuous(name = "temp",
limits = c(20,105))+
theme_light()+
labs(title = "title", subtitle = "subtitle", caption = "caption", tag = "tag")
mean_temps <- temps_long %>%
group_by(month,location) %>%
summarize(mean = mean(temperature)) %>%
ungroup() %>%
mutate(month = factor(month %>% paste(),
levels = 1:12 %>% paste()))
# 패키지
rm(list = ls())
#시군구 지도 데이터, 행정구역 코드 10자리로 만들기
kor_sigu <- geojson_sf("https://raw.githubusercontent.com/Sungileo/trainsets/main/kor/KOR_SIGU.json")
use_map <- kor_sigu
use_map$행정구역_코드 <- paste(use_map$SIG_CD,"00000",sep = "")
#2023년 3월 주민등록 인구통계 데이터, 행정안전부
data_pop <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/202303_202303_%EC%A3%BC%EB%AF%BC%EB%93%B1%EB%A1%9D%EC%9D%B8%EA%B5%AC%EB%B0%8F%EC%84%B8%EB%8C%80%ED%98%84%ED%99%A9_%EC%9B%94%EA%B0%84.csv",encoding = "utf-8")
data_pop %>% head()
# 전처리, 인구수0명 출장소 제외, 행정구역 코드 10자리 추출,
# 인구수 숫자형으로 변환, 시 단위 제외, 정렬
data_202303 <- data_pop %>%
filter(X2023년03월_총인구수>0) %>%
select(행정구역,X2023년03월_총인구수) %>%
mutate(행정구역_코드 = str_sub(행정구역,-11,-2),
X2023년03월_총인구수 = gsub(",","",X2023년03월_총인구수) %>% as.numeric()) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
arrange(desc(X2023년03월_총인구수))
data_202303 %>% head()
# 병합
use_map <- use_map %>% merge(data_202303,by = "행정구역_코드", all.x=T)
#Plot
use_map %>% ggplot(aes(fill=X2023년03월_총인구수))+
geom_sf(color = "grey90")+
coord_sf(datum = NA)+
scale_fill_distiller(
name = "2023년 3월 인구수",
palette = "Blues", type = "seq", na.value = "grey60",
direction = 1,
breaks = seq(0,10,2) * 1e+5,
labels = format(seq(0,10,2) * 1e+5, big.mark = ",",scientific = FALSE))+
theme_minimal()+
theme(
legend.title.align = 0.5,
legend.text.align = 1.0,
legend.position = c(0.85,0.2))+
labs(title = "2023년 3월")
