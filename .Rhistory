direction = 1)+
theme_light()+
theme(panel.border = element_blank())
ggplot(temps_long, aes(x=date,y=temperature,color=location))+
geom_line(linewidth = 1.1)+
scale_x_date(name = "month",
breaks = break_date,
labels = date_lab)+
scale_y_continuous(name = "temperature",
limits = c(0,105))+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
#data_2021 %>% names()
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
theme_light()
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
theme_light()
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
coord_polar()+
theme_light()
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
coord_polar()+
theme_light()+
theme(panel.border = element_blank())
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온",
limits = c(-20,40))+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온",
limits = c(-20,35))+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
View(data_2022)
#data_2021 %>% names()
ggplot(data_2021,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_21,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
theme_light()
data_2022 <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/OBS_ASOS_DD_20230322080932.csv", fileEncoding = "euc-kr")
data_2022 %>% dim()
data_2022 %>% head()
data_2022 %>% sapply(class)
data_2022$일시 <-data_2022$일시 %>% as.Date("%Y-%m-%d")
data_2022 %>% sapply(class)
data_2022 %>% summary()
date_22s <- "2022-01-01" %>% as.Date("%Y-%m-%d")  #Y는 대문자
date_22e <- "2023-01-01" %>% as.Date("%Y-%m-%d")
break_date_22 <- seq.Date(date_22s, date_22e, by = "3 month")
date_22s <- "2022-01-01" %>% as.Date("%Y-%m-%d")  #Y는 대문자
date_22e <- "2023-01-01" %>% as.Date("%Y-%m-%d")
break_date_22 <- seq.Date(date_22s, date_22e, by = "3 month")
#data_2021 %>% names()
ggplot(data_2022,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
theme_light()
data_2022
data_2022$지점명 %>% unique()
data_2022_2 <- data_2022 %>% filter(data_2022$지점명=="서울"|"대전"|"제주"|"세종")
data_2022_2 <- data_2022 %>% filter(data_2022$지점명=="서울")
data_2022_2
data_2022_2 <- data_2022 %>% filter(data_2022$지점명=="서울","대전")
data_2022_2 <- data_2022 %>% filter(data_2022$지점명==c("서울","대전"))
data_2022_2
data_2022_2$지점명 %>% unique()
data_2022_2 <- data_2022 %>% filter(data_2022$지점명==c("서울","대전","제주","세종"))
data_2022_2$지점명 %>% unique()
#data_2021 %>% names()
ggplot(data_2022_2,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온")+
theme_light()
ggplot(data_2022_2,aes(x = 일시,y = 평균기온..C., color = 지점명))+
geom_line(linewidth = 1) +
scale_x_date(name ="월",
breaks = break_date_22,
labels = c("1월","4월","7월","10월","1월")) +
scale_y_continuous(name = "평균기온",
limits = c(-20,35))+
coord_polar(theta = "x",
start = pi,
direction = 1)+
theme_light()+
theme(panel.border = element_blank())
kor_202202 <- read.csv("https://raw.githubusercontent.com/Sungileo/trainsets/main/202202_%EC%A3%BC%EB%AF%BC%EB%93%B1%EB%A1%9D%EC%9D%B8%EA%B5%AC%EB%B0%8F%EC%84%B8%EB%8C%80%ED%98%84%ED%99%A9.csv")
kor_202202
kor_202202 %>% head()
kor_202202 %>% sapply(class)
kor_202202$행정구역_코드 <- kor_202202$행정구역_코드 %>% format()
kor_202202 %>% sapply(class)
data_2022_2 <- data_2022 %>% filter(data_2022$지점명==c("서울","대전","제주","세종"))
data_2022_2 <- data_2022 %>% filter(data_2022$지점명 %in% c("서울","대전","제주","세종"))
data_2022_2$지점명 %>% unique()
kor_202202_use <- kor_202202 %>%
filter(substr(행정구역,1,2) %in% c("서울","대전","대구","부산")) %>%
filter(substr(행정구역_코드,3,4)!="00") %>%
select(행정구역,총인구수) %>%
arrange(총인구수)
kor_202202_use %>% View()
kor_202202_use$시도 = sapply(kor_202202_use$행정구역,
function(x) strsplit(x, " ")[[1]][1])
kor_202202_use$시도
kor_202202_use$시도 %>% unique()
kor_202202_use$시도 = factor(kor_202202_use$시도,
levels = c("부산광역시","대구광역시","서울특별시","대전광역시"))
kor_202202_use
kor_202202_use %>% head()
kor_202202_use %>% summary()
region_colors
state_colors
state_colors <- region_colors[as.numeric(kor_202202_use$시도)]
state_colors_dark <- colorspace::darken(state_colors,0.4)
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
them_light()
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()
kor_202202_use$시도 = factor(kor_202202_use$시도,
levels = c("서울특별시","대전광역시","대구광역시","부산광역시"))
kor_202202_use %>% head()
kor_202202_use %>% summary()
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 10,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 10,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 8,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 2,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 5,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 7,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
View(kor_202202_use)
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(1,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(100,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
state_colors <- region_colors[as.numeric(kor_202202_use$시도)]
state_colors_dark <- colorspace::darken(state_colors,0.4)
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
#axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
#coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
ggplot(kor_202202_use,aes(x = reorder(행정구역, 총인구수),y= 총인구수, fill = 시도))+
geom_col()+
scale_y_continuous(name = "총인구수, 2022년 2월",
expand = c(0,0),
labels = scales::comma)+
scale_x_discrete(aes(color=state_colors))+
scale_color_manual(values = state_colors)+
scale_fill_manual(values = region_colors)+
coord_flip()+
theme_light()+
theme(panel.border = element_blank(),
panel.grid.major.y = element_blank())+
theme(axis.title.y = element_blank(),
axis.line.y = element_blank(),
axis.ticks.length = unit(0,"pt"),
axis.text.y = element_text(size = 6,color = state_colors_dark),legend.position = c(.78,.28),legend.background = element_rect(fill = "#FFFFFFB0"))
