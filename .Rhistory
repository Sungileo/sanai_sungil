data_nm_raw <- read.csv("C:/Users/sungi/Documents/linear_model_dataset_R.csv")
data_nm_raw <- data_nm_raw %>% mutate(평단가 = 거래금액/전용면적)
data_nm <- data_nm_raw %>%
group_by(아파트) %>%
summarize(평균거래액 = mean(평단가) %>% as.integer(),
Latitude = mean(Latitude),
Longitude = mean(Longitude)) %>%
mutate(정보 = paste(아파트,평균거래액,sep = ", 평단가 :"))
data_nm_sf <- data_nm %>% st_as_sf(coords = c("Longitude","Latitude"))
st_crs(data_nm_sf) <- 4737
cheonan <- cheonan %>%
filter(EMD_NM!="광덕면")
gn <- ggplot()+
geom_sf(data = cheonan,color = "black")+
geom_sf(data = data_nm_sf,aes(fill = 정보))+
theme_minimal()+
theme(legend.position = "none")
gn %>% ggplotly()
tmap_mode("view")
tmap_options(check.and.fix = TRUE)
tm_shape(cheonan["EMD_NM"])+
tm_polygons(col="white",alpha = 0.3)+
tm_shape(data_nm_sf["정보"])+
tm_symbols(shape = 2, col = "red", size = 0.05)
View(data_nm_sf)
tm_shape(cheonan["EMD_NM"])+
tm_polygons(col="white",alpha = 0.3)+
tm_shape(data_nm_sf["정보"])+
tm_symbols(shape = 2, col = ifelse(data_nm_sf$평균거래액 > mean(data_nm_sf$평균거래액), "red", "blue"), size = 0.05)
tm_shape(cheonan["EMD_NM"])+
tm_polygons(col="white",alpha = 0.3)+
tm_shape(data_nm_sf["정보"])+
tm_symbols(shape = 2, col = ifelse(data_nm_sf$평균거래액 > mean(data_nm_sf$평균거래액), "red", "blue"), size = 0.05)
tm_shape(cheonan
library(viridis)
tm_shape(cheonan["EMD_NM"]) +
tm_polygons(col="white", alpha=0.3) +
tm_shape(data_nm_sf["정보"]) +
tm_symbols(
col = data_nm_sf$평균거래액,
shape = 2,
scale = scale_color_gradient(
low = "blue", high = "red", option = "viridis"
),
size = 0.05
)
library(viridis)
tm_shape(cheonan["EMD_NM"]) +
tm_polygons(col="white", alpha=0.3) +
tm_shape(data_nm_sf["정보"]) +
tm_symbols(
col = data_nm_sf$평균거래액,
shape = 2,
scale = scale_color_gradient(
low = "blue", high = "red", option = "viridis"
),
size = 0.05
)
gc()
regions  <-  aggregate(x = us_states[, "total_pop_15"], by = list(us_states$REGION),
FUN = sum, na.rm = TRUE)
plot(regions[2])
#2. group_by, summarize함수
regions2  <-  us_states %>% group_by(REGION) %>%
summarize(pop = sum(total_pop_15, na.rm = TRUE))
plot(regions2[2])
regions  <-  aggregate(x = us_states[, "total_pop_15"], by = list(us_states$REGION),
FUN = sum, na.rm = TRUE)
plot(regions[2])
regions2  <-  us_states %>%
group_by(REGION) %>%
summarize(pop = sum(total_pop_15, na.rm = TRUE))
plot(regions2[2])
us_west  <-  us_states[us_states$REGION == "West", ]
us_west_union  <-  st_union(us_west)
plot(us_west_union)
texas <-  us_states[us_states$NAME == "Texas", ]
texas_union  <-  st_union(us_west_union, texas)
plot(texas_union)
us_states %>% View()
us_west_union
us_west  <-  us_states[us_states$REGION == "West", ]
us_west_union  <-  st_union(us_west)
plot(us_west_union)
texas <-  us_states[us_states$NAME == "Texas", ]
texas_union  <-  st_union(us_west_union, texas)
plot(texas_union)
subplot(a,b)
us_west  <-  us_states[us_states$REGION == "West", ]
us_west_union  <-  st_union(us_west)
a <- plot(us_west_union)
texas <-  us_states[us_states$NAME == "Texas", ]
texas_union  <-  st_union(us_west_union, texas)
b <- plot(texas_union)
subplot(a,b)
a <- plot(us_west_union)
b <- plot(texas_union)
subplot(a,b)
subplot(a,b,nrows = 1)
us_west  <-  us_states[us_states$REGION == "West", ]
us_west_union  <-  st_union(us_west)
plot(us_west_union)
texas <-  us_states[us_states$NAME == "Texas", ]
texas_union  <-  st_union(us_west_union, texas)
plot(texas_union)
multipoint <-  st_multipoint(matrix(c(1, 3, 5, 1, 3, 1), ncol = 2))
linestring <-  st_cast(multipoint, "LINESTRING")
polyg <-  st_cast(multipoint, "POLYGON")
plot(multipoint)
plot(linestring)
plot(polyg)
st_length(linestring) #길이계산
st_area(polyg) #면적계산
plot(polyg,col = "red")
multipoint <-  st_multipoint(matrix(c(1, 3, 5, 1, 3, 1), ncol = 2))
linestring <-  st_cast(multipoint, "LINESTRING")
polyg <-  st_cast(multipoint, "POLYGON")
plot(multipoint)
plot(linestring)
plot(polyg,col = "lightblue")
st_length(linestring) #길이계산
st_area(polyg) #면적계산
matrix(c(1, 3, 5, 1, 3, 1), ncol = 2)
multipoint <-  st_multipoint(matrix(c(1, 3, 5, 1, 3, 1), ncol = 2))
linestring <-  st_cast(multipoint, "LINESTRING")
polyg <-  st_cast(multipoint, "POLYGON")
plot(multipoint)
plot(linestring)
plot(polyg,col = "lightblue")
st_length(linestring) #길이계산
st_area(polyg) #면적계산
multipoint <-  st_multipoint(matrix(c(1, 3, 5,
1, 3, 1), ncol = 2))
linestring <-  st_cast(multipoint, "LINESTRING")
polyg <-  st_cast(multipoint, "POLYGON")
plot(multipoint)
plot(linestring)
plot(polyg,col = "lightblue")
st_length(linestring) #길이계산
st_area(polyg) #면적계산
multilinestring_list <-  list(matrix(c(1, 4, 5, 3), ncol = 2),
matrix(c(4, 4, 4, 1), ncol = 2),
matrix(c(2, 4, 2, 2), ncol = 2))
multilinestring <- st_multilinestring((multilinestring_list))
multilinestring_sf <-  st_sf(geom = st_sfc(multilinestring))
multilinestring_sf
plot(multilinestring_sf)
multilinestring_list <-  list(matrix(c(1, 4, 5, 3), ncol = 2),
matrix(c(4, 4, 4, 1), ncol = 2),
matrix(c(2, 4, 2, 2), ncol = 2))
multilinestring <- st_multilinestring((multilinestring_list))
multilinestring_sf <-  st_sf(geom = st_sfc(multilinestring))
multilinestring_sf
plot(multilinestring_sf)
linestring_sf2 = st_cast(multilinestring_sf, "LINESTRING")
linestring_sf2
multilinestring_list <-  list(matrix(c(1, 4, 5, 3), ncol = 2),
matrix(c(4, 4, 4, 1), ncol = 2),
matrix(c(2, 4, 2, 2), ncol = 2))
multilinestring <- st_multilinestring((multilinestring_list))
multilinestring_sf <-  st_sf(geom = st_sfc(multilinestring))
multilinestring_sf
plot(multilinestring_sf)
linestring_sf2 = st_cast(multilinestring_sf, "LINESTRING")
linestring_sf2
linestring_sf2$name  <-  c("Riddle Rd", "Marshall Ave", "Foulke St")
linestring_sf2$length <-  st_length(linestring_sf2)
linestring_sf2
plot(linestring_sf2[2])
View(linestring_sf2)
library(readxl)
library(tidyverse)
library(car)
library(corrplot)
library(plotly)
library(olsrr)
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
data %>% head()
data %>% head()
#| warning: false
#| message: false
library(readxl)
library(tidyverse)
library(car)
library(corrplot)
library(plotly)
library(olsrr)
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
data %>% head()
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor,type = "box",name = "층")
c <- plot_ly(y=data$station_m,type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area,type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m,type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m,type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
data <- data %>%
filter(school_m < 1135) %>%
filter(market_m < 3156) %>%
filter(foreign_ratio < 0.11) %>%
filter(floor < 29) %>%
filter(station_m < 4366) %>%
filter(dong_area < 33.02)
data %>% nrow()
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
model <- lm(price_per_pyeong ~ ., data = data)
summary(model)
model %>% vif()
model_2 <- step(model,direction = "both")
model_2 %>% summary()
plot(model_2)
ols_plot_cooksd_bar(model_2)
cooked_dist <- cooks.distance(model_2)
data_2 <- data %>%
cbind(cooked_dist) %>%
filter(cooked_dist<0.005)
model_3 <- lm(price_per_pyeong ~ year_built+floor+pop+dong_area+foreign_ratio+school_m+market_m , data=data_2)
model_3 <- step(model_3,direction = "both")
model_3 %>% summary()
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
rm(list = ls())
#| warning: false
#| message: false
rm(list = ls())
library(readxl)
library(tidyverse)
library(car)
library(corrplot)
library(plotly)
library(olsrr)
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
data %>% head()
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor,type = "box",name = "층")
c <- plot_ly(y=data$station_m,type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area,type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m,type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m,type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
data <- data %>%
filter(school_m < 1135) %>%
filter(market_m < 3156) %>%
filter(foreign_ratio < 0.11) %>%
filter(floor < 29) %>%
filter(station_m < 4366) %>%
filter(dong_area < 33.02)
data %>% nrow()
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
model <- lm(price_per_pyeong ~ ., data = data)
summary(model)
model %>% vif()
model_2 <- step(model,direction = "both")
model_2 %>% summary()
plot(model_2)
ols_plot_cooksd_bar(model_2)
cooked_dist <- cooks.distance(model_2)
data_2 <- data %>%
cbind(cooked_dist) %>%
filter(cooked_dist<0.005)
model_3 <- lm(price_per_pyeong ~ year_built+floor+pop+dong_area+foreign_ratio+school_m+market_m , data=data_2)
model_3 <- step(model_3,direction = "both")
model_3 %>% summary()
#| warning: false
#| message: false
rm(list = ls())
library(readxl)
library(tidyverse)
library(car)
library(corrplot)
library(plotly)
library(olsrr)
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
data %>% head()
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor,type = "box",name = "층")
c <- plot_ly(y=data$station_m,type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area,type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m,type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m,type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
data <- data %>%
filter(school_m < 1135) %>%
filter(market_m < 3156) %>%
filter(foreign_ratio < 0.11) %>%
filter(floor < 29) %>%
filter(station_m < 4366) %>%
filter(dong_area < 33.02)
data %>% nrow()
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
model <- lm(price_per_pyeong ~ ., data = data)
summary(model)
model %>% vif()
model_2 <- step(model,direction = "both")
model_2 %>% summary()
plot(model_2)
ols_plot_cooksd_bar(model_2)
cooked_dist <- cooks.distance(model_2)
data_2 <- data %>%
cbind(cooked_dist) %>%
filter(cooked_dist<0.005)
model_3 <- lm(price_per_pyeong ~ year_built+floor+pop+dong_area+foreign_ratio+school_m+market_m , data=data_2)
model_3 <- step(model_3,direction = "both")
model_3 %>% summary()
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor %>% log(),type = "box",name = "층")
c <- plot_ly(y=data$station_m %>% log(),type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area %>% log(),type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m %>% log(),type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m %>% log(),type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor,type = "box",name = "층")
c <- plot_ly(y=data$station_m,type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area,type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m,type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m,type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor %>% log(),type = "box",name = "층")
c <- plot_ly(y=data$station_m %>% log(),type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area %>% log(),type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m %>% log(),type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m %>% log(),type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor %>% log(),type = "box",name = "층")
c <- plot_ly(y=data$station_m %>% log(),type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area %>% log(),type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m %>% log(),type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m %>% sqrt(),type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
h <- plot_ly(y=data$market_m %>% log(),type = "box",name = "대형마트 거리")
a <- plot_ly(y=data$year_built,type = "box",name = "건축년도")
b <- plot_ly(y=data$floor %>% log(),type = "box",name = "층")
c <- plot_ly(y=data$station_m %>% log(),type = "box",name = "전철역 거리")
d <- plot_ly(y=data$pop,type = "box",name = "법정동 인구수")
e <- plot_ly(y=data$dong_area %>% log(),type = "box",name = "법정동 크기")
f <- plot_ly(y=data$foreign_ratio,type = "box",name = "법정동 외국인 비율")
g <- plot_ly(y=data$school_m %>% log(),type = "box",name = "초등학교 거리")
h <- plot_ly(y=data$market_m %>% log(),type = "box",name = "대형마트 거리")
i <- plot_ly(y=data$price_per_pyeong,type = "box",name = "평당 가격")
subplot(a,b,c,d,e,f,g,h,i,nrows = 3)
data %>% mutate(floor = floor %>% log(),
station_m = station_m %>% log(),
dong_area = dong_area %>% log(),
school_m = school_m %>% log(),
market_m = market_m %>% log()) %>% View()
data <- data %>% mutate(floor = floor %>% log(),
station_m = station_m %>% log(),
dong_area = dong_area %>% log(),
school_m = school_m %>% log(),
market_m = market_m %>% log())
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
data %>% filter(station_m>5.5|station_m<9.375) %>% nrow()
data %>% filter(station_m>5.5&station_m<9.375) %>% nrow()
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>% nrow()
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>% nrow()
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
nrow()
data <- data %>% mutate(floor = floor %>% log(),
station_m = station_m %>% log(),
dong_area = dong_area %>% log(),
school_m = school_m %>% log(),
market_m = market_m %>% log())
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
filter(market_m<4.66&market_m>9.009) %>%
nrow()
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
filter(market_m<4.66&market_m>9.009) %>%
nrow()
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
filter(market_m>4.66&market_m<9.009) %>%
nrow()
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
filter(market_m>4.66 & market_m<9.009) %>%
nrow()
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
filter(market_m>4.66 & market_m<9.009) %>%
nrow()
data <- read_excel("C:/linear_model_dataset_R.xlsx")
data <- data %>% select(-c(Latitude,Longitude))
names(data) <- c("year_built","floor","station_m","pop","dong_area","foreign_ratio","school_m","market_m","price_per_pyeong")
data <- data %>% mutate(floor = floor %>% log(),
station_m = station_m %>% log(),
dong_area = dong_area %>% log(),
school_m = school_m %>% log(),
market_m = market_m %>% log())
data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
filter(market_m>4.66 & market_m<9.009) %>%
nrow()
1059-989
data <- data %>%
filter(station_m>5.5&station_m<9.375) %>%
filter(floor>-0.139) %>%
filter(foreign_ratio<0.1176) %>%
filter(school_m<7.607) %>%
filter(market_m>4.66 & market_m<9.009)
data_cor <- cor(data)
data_cor
corrplot(data_cor,
method = "shade",
addCoef.col="black",
tl.col = "black")
model <- lm(price_per_pyeong ~ ., data = data)
summary(model)
model %>% vif()
model_2 <- step(model,direction = "both")
model_2 %>% summary()
plot(model_2)
ols_plot_cooksd_bar(model_2)
cooked_dist <- cooks.distance(model_2)
data_2 <- data %>%
cbind(cooked_dist) %>%
filter(cooked_dist<0.005)
model_3 <- lm(price_per_pyeong ~ year_built+floor+pop+dong_area+foreign_ratio+school_m+market_m , data=data_2)
model_3 <- step(model_3,direction = "both")
model_3 %>% summary()
989-952
cooked_dist <- cooks.distance(model_2)
data_2 <- data %>%
cbind(cooked_dist) %>%
filter(cooked_dist<0.005)
model_3 <- lm(price_per_pyeong ~ year_built+floor+pop+dong_area+foreign_ratio+school_m+market_m , data=data_2)
model_3 <- step(model_3,direction = "both")
model_3 %>% summary()
model_3 %>% plot()
ols_plot_cooksd_bar(model_3)
